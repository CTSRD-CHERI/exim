# TLS: EC curves for OpenSSL
#
# This is only checking the acceptability of option settings, not their effect
# See packet captures for actual effects
#
# Baseline: tls_eccurve option not present
exim -DSERVER=server -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
# Explicit tls_eccurve setting of "auto"
exim -DSERVER=server -DDATA=auto -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
# Explicit tls_eccurve setting of ""
# - unclear this works.  At least with OpenSSL 3.0.5 we still get an x25519 keyshare in the Server Hello
exim -DSERVER=server -DDATA= -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
# prime256v1
exim -DSERVER=server -DDATA=prime256v1 -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
# X448
# Client Hello offers an x25519 keyshare, server says "Hello Retry Request" with a KeyShare extension "X448"
# and the client retries Client Hello with that in the KeyShare.
exim -DSERVER=server -DDATA=X448 -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
# "bogus".  Should fail to make connection.
exim -DSERVER=server -DDATA=bogus -bd -oX PORT_D
****
exim -odf userx@test.ex
****
killdaemon
#
#
no_message_check
