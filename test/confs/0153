# Exim test configuration 0153

.include DIR/aux-var/std_conf_prefix


# ----- Main settings -----


# ----- Routers -----

begin routers

virtual:
  driver = redirect
  domains = *.virt.test.ex
#  address_data = ${if match{$domain}{^(.*)\\.virt\\.test\\.ex\$}{${bless:$1}}}
  address_data = $1
#  data = ${if exists{DIR/aux-fixed/TESTNUM.alias.$address_data} \
#           {${lookup{$local_part}lsearch{DIR/aux-fixed/TESTNUM.alias.$address_data}}} \
#          fail}
  data = ${lookup {TESTNUM.alias.$address_data} dsearch,ret=full {DIR/aux-fixed} \
           {${lookup{$local_part}lsearch{$value}}} \
	   fail}
  no_more

list:
  driver = redirect
  domains = list.test.ex
#  file = ${if exists{DIR/aux-fixed/TESTNUM.list.${bless:$local_part}} \
#            {DIR/aux-fixed/TESTNUM.list.${bless:$local_part}}fail}
  file = ${lookup {TESTNUM.list.$local_part} dsearch,ret=full {DIR/aux-fixed} {$value}fail}
  no_more

real:
  driver = accept
  verify_only


# End
