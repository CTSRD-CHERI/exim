# Exim test configuration 0032

.include DIR/aux-var/std_conf_prefix

primary_hostname = myhost.ex


# ----- Main settings -----

dsn_from = MailProgram <xyz@some.where>

acl_not_smtp = add_insane_refs


# ----- ACL -----

begin acl

# Put an overlong refs header on the message-to-be-bounced, so we can check the
# bounce has a sane header

add_insane_refs:
  warn	!senders =	:
  	add_header =	References: \
			<0.ZERO.78901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.ONE.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.TWO.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.THREE.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.FOUR.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.FIVE.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.SIX.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.SEVEN.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.EIGHT.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.NINE.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.TEN.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.ELEVEN.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net> \
			<0.TWELVE.678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678@f.net>
  accept

# ----- Routers -----

begin routers

localuser:
  driver = accept
  check_local_user
  transport = local_delivery

others:
  driver = dnslookup
  transport = smtp
  self = fail


# ----- Transports -----

begin transports

local_delivery:
  driver = appendfile
  delivery_date_add
  envelope_to_add
  file = DIR/test-mail/$local_part
  create_file = DIR/test-mail
  return_path_add

smtp:
  driver = smtp
  hosts_try_fastopen =	:


# End
